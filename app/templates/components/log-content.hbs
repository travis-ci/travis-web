<section id="log-container" class="log">
  <section style='background: rgba(255,255,255,0.6); margin-bottom: 20px;'>
    Job state:
    <button style='border: 2px solid #3EAAAF; cursor: pointer; margin-right: 10px;' onclick={{action (mut job.state) 'created'}}>Created(1)</button>
    <button style='border: 2px solid #3EAAAF; cursor: pointer; margin-right: 10px;' onclick={{action (mut job.state) 'queued'}}>Queued(2)</button>
    <button style='border: 2px solid #3EAAAF; cursor: pointer; margin-right: 10px;' onclick={{action (mut job.state) 'received'}}>Received(3)</button>
    <button style='border: 2px solid #3EAAAF; cursor: pointer; margin-right: 10px;' onclick={{action (mut job.state) 'started'}}>Started(Show log)</button>
  </section>
  {{#if job.notStarted}}
  <div class="job-waiting-stages-container">
    <div class="stage-loading stage-1-container {{if job.created 'spinner-container'}} {{if job.toBeStarted 'stage-loaded-ring'}}">
      <svg class="{{if job.created 'spinner'}}" x="0px" y="0px" viewBox="0 0 150 150">
        <circle id="loading-inner" cx="75" cy="75" r="68"/>
      </svg>
      <span class="waiting-stage-1-text stage-text {{if job.created 'loading-num-text'}} {{if job.toBeStarted 'stage-loaded-text'}}">1</span>
    </div>
    <div class="stage-message stage-1-message {{if job.created 'show-stage-message'}} {{if job.toBeStarted 'hide-stage-message'}}">Job received</div>
    <span class="loading-line-container loading-line-container-1">
      <span class="loading-line-1" class="{{if job.toBeStarted 'loading-line'}}"></span>
    </span>
   <div class="stage-loading stage-2-container {{if job.created 'not-loaded-ring'}} {{if job.queued 'spinner-container'}} {{if job.received 'stage-loaded-ring'}}">
     <svg class="{{if job.queued 'spinner'}}" x="0px" y="0px" viewBox="0 0 150 150">
       <circle id="loading-inner" cx="75" cy="75" r="68"/>
     </svg>
      <span class="waiting-stage-2-text stage-text {{if job.queued 'loading-num-text'}} {{if job.received 'stage-loaded-text'}}">2</span>
    </div>
    <div class="stage-message stage-2-message {{if job.queued 'show-stage-message'}} {{if job.created 'hide-stage-message'}} {{if job.received 'hide-stage-message'}}">Queued</div>
    <div class="loading-line-container loading-line-container-2">
      <span class="loading-line-2" class="{{if job.received 'loading-line'}}"></span>
    </div>
    <div class="stage-loading stage-3-container {{if job.queued 'not-loaded-ring'}} {{if job.created 'not-loaded-ring'}} {{if job.received 'spinner-container'}} {{if job.started 'stage-loaded-ring'}}">
      <svg class="{{if job.received 'spinner'}}" x="0px" y="0px" viewBox="0 0 150 150">
        <circle id="loading-inner" cx="75" cy="75" r="68"/>
      </svg>
      <span class="waiting-stage-3-text stage-text {{if job.received 'loading-num-text'}} {{if job.started 'stage-loaded-text'}}">3</span>
    </div>
    <div class="stage-message stage-3-message {{if job.received 'show-stage-message'}} {{if job.created 'hide-stage-message'}} {{if job.queued 'hide-stage-message'}} {{if job.started 'hide-stage-message'}}">Booting virtual machine</div>
  </div>
  {{/if}}

  {{#if job.reQueue}}
    <div class="log-notice">Back to the queue...</div>
  {{/if}}

  {{#if job.inQueue}}
    <div class="log-notice">Hang tight, this job is next...</div>
  {{/if}}

  {{#if job.toBeCreated}}
    <div class="log-notice">Things are being created...</div>
  {{/if}}
  <div class="log-container {{if job.notStarted 'hidden'}}">
      <button type="button" class="toggle-log-button {{if logIsVisible 'hidden'}}" title="Display the log" {{action "toggleLog"}}>
      {{svg-jar 'icon-seemore' class="icon"}}
      <span class="label-align">View log</span></button>

    <div class="log-main {{if logIsVisible 'is-visible'}} {{if job.notStarted 'hidden'}}">
      <div class="log-header">
          <button type="button" class="toggle-log-button--dark {{unless logIsVisible 'hidden'}}" title="Display the log" {{action "toggleLog"}}>
              {{svg-jar 'icon-seemore' class="icon"}}<span class="label-align">Hide log</span></button>
        {{#if canRemoveLog}}
          <button class="remove-log-button open-popup" {{action "toggleRemoveLogModal"}} title="Remove the log" type="button">
            {{svg-jar 'icon-deletelogs' class="icon"}} Remove log</button>
        {{/if}}
        <a class="download-log-button" href={{plainTextLogUrl}} title="Display the log in plaintext">
          {{svg-jar 'icon-downloadlogs' class="icon"}} Raw log</a>
      </div>
      <div class="log-body">
        {{#if showTailing}}
          <a href="#" id="tail" class="log-tail" {{action "toggleTailing"}}>
            <span class="tail-status"></span>
            <span class="tail-label">
              {{svg-jar 'icon-arrowdown' class="icon-arrow"}}
              {{#if job.isFinished}}
                Scroll to End of Log
              {{else}}
                Follow Log
              {{/if}}
            </span>
          </a>
        {{/if}}

        <pre id="log" class="ansi"></pre>

        {{#if showToTop}}
          <a href='#' class="to-top" {{action "toTop"}}>Top</a>
        {{/if}}
      </div>
    </div>

    {{#if limited}}
      <p class="warning notice-banner--red">
        This log is too long to be displayed. Please reduce the verbosity of your
        build or download the <a href={{plainTextLogUrl}}>raw log</a>.
      </p>
    {{/if}}
  </div>
</section>

{{#if isShowingRemoveLogModal}}
  {{#modal-dialog
     onClose="toggleRemoveLogModal"
     targetAttachment="center"
     translucentOverlay=true}}
    {{remove-log-popup job=job onCloseModal=(action 'toggleRemoveLogModal')}}
  {{/modal-dialog}}
{{/if}}
