<TravisForm
  @onSubmit={{perform this.triggerBuild}}
  as |form|
>
  <div class="request-configs-fields" data-test-request-config-form='true'>
    <div class="request-configs-fields-container">
      <div class="form-elem">
        <form.field
          data-test-request-configs-branch="true"
          @label="Branch"
          @classNames="ref-type-branch"
          @placeholder="Select a branch"
          @value={{this.branch}}
          @showValidationStatusIcons={{false}}
          @onChange={{action "change" "branch"}}
          as |field|
        >
          <field.select
            @search={{perform this.searchBranches}}
            as |branch|
          >
            {{branch}}
          </field.select>
        </form.field>
      </div>

      <div class="form-elem">
        <form.field
          data-test-request-configs-sha="true"
          @label="Commit"
          @placeholder="Specify a Git sha (optional)"
          @value={{this.sha}}
          @showValidationStatusIcons={{false}}
          @onChange={{action "change" "sha"}}
          as |field|
        >
          {{field.input}}
        </form.field>
      </div>
    </div>

    <div class="form-elem">
      <form.field
        data-test-request-configs-message="true"
        @classNames="ref-type-sha"
        @value={{this.message}}
        @label="Message"
        @onChange={{action "change" "message"}}
        @placeholder="Overwrite the commit message (optional)"
        as |field|
      >
        {{field.input}}
      </form.field>
    </div>

    <div class="form-elem">
      <form.field
        data-test-request-configs-config="true"
        @label="Custom Build Config"
        as |field|
      >
        <div class="config-type {{this.configMode}} tooltip-wrapper">
          <span class="yaml">YAML</span>
          <span class="javascript">JSON</span>
          <EmberTooltip @text="Detected build config format" />
        </div>

        <IvyCodemirror
          @value={{this.config}}
          @valueUpdated={{action "change" "config"}}
          @options={{hash
            mode=this.configMode
            lineNumbers=true
            tabSize=2
            indentWithTabs=false
            placeholder="Overwrite build config"
          }}
        />

        <Request::Messages
          @request={{this.request}}
          @messages={{this.messages}}
          @loading={{this.loading}}
        />

      </form.field>
    </div>

    <div class="form-elem">
      <h4 class="request-configs-heading">
        Merge mode
      </h4>
      <RadioButton
        @value="deep_merge_append"
        @groupValue={{mergeMode}}
        @changed={{action "change" "mergeMode"}}
      >
        Deep Merge &amp; Append
      </RadioButton>
      <RadioButton
        @value="deep_merge_prepend"
        @groupValue={{mergeMode}}
        @changed={{action "change" "mergeMode"}}
      >
        Deep Merge &amp; Prepend
      </RadioButton>
      <RadioButton
        @value="deep_merge"
        @groupValue={{mergeMode}}
        @changed={{action "change" "mergeMode"}}
      >
        Deep Merge
      </RadioButton>
      <RadioButton
        @value="merge"
        @groupValue={{mergeMode}}
        @changed={{action "change" "mergeMode"}}
      >
        Merge
      </RadioButton>
      <RadioButton
        @value="replace"
        @groupValue={{mergeMode}}
        @changed={{action "change" "mergeMode"}}
      >
        Replace
      </RadioButton>

      <ExternalLinkTo class="hint" href="{{config-get 'urls.triggerBuildMergeModes'}}">
        <SvgImage @name='icon-help' @class='icon-help' />
      </ExternalLinkTo>
    </div>
  </div>
</TravisForm>
