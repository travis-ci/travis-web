{{#if this.showNewConfigView}}
  {{#if this.canTriggerBuild}}
    <Request::ConfigsButtons
      @onCancel={{action this.onCancel}}
      @onCustomize={{action this.onCustomize}}
      @onPreview={{action this.onPreview}}
      @onTrigger={{action this.onTrigger}}
      @closed={{this.closed}}
      @submitting={{this.submitting}}
    />
  {{/if}}

  {{#if this.closed}}
    <Request::Messages
      @request={{this.request}}
      @messages={{this.request.messages}}
      @viewMessage={{action (mut this.viewingMessage)}}
    />
  {{else}}
    <Request::ConfigsTriggerBuildNotice
      @configs={{this.rawConfigs.length}}
      @status={{this.status}}
    />
  {{/if}}

  {{#if this.customizing}}
    <Request::ConfigForm
      @request={{this.request}}
      @configs={{this.configs}}
      @refType={{this.refType}}
      @branch={{this.branch}}
      @sha={{this.sha}}
      @message={{this.message}}
      @mergeMode={{this.mergeMode}}
      @loading={{this.loading}}
      @messages={{this.messages}}
      @onAdd={{action "add"}}
      @onRemove={{action "remove"}}
      @onChange={{action "update"}}
      @onSubmit={{action "submit"}}
    />

    <Request::Messages
      @request={{this.request}}
      @messages={{this.messages}}
      @loading={{this.loading}}
    />

    {{#unless this.replacing}}
      <h4 class="request-configs-heading">
        Build {{pluralize this.rawConfigs.length 'Config' without-count=true}}
      </h4>
    {{/unless}}
  {{/if}}

  {{#if this.previewing}}
    <Request::ConfigsPreview
      @preview={{this.preview}}
    />
  {{/if}}

  {{#unless (or this.replacing this.previewing)}}
    <h4 class="request-configs-heading">
      Build {{pluralize this.rawConfigs.length 'Config' without-count=true}}
    </h4>

    {{#each this.rawConfigs as |config|}}
      <Request::RawConfig
        data-test-raw-config="true"
        @source={{config.source}}
        @config={{get config 'config'}}
        @loading={{this.loading}}
        @build={{@request.build}}
        @slug={{@request.repo.slug}}
      />
    {{/each}}

    <Request::Config
      data-test-request-config="true"
      @config={{this.request.config}}
    />
  {{/unless}}

{{else}}
  <Request::Messages
    @request={{this.request}}
    @messages={{this.request.messages}}
    @viewMessage={{action (mut this.viewingMessage)}}
  />

  <div class="raw-configs">
    {{#each @request.uniqRawConfigs as |config|}}
      <Request::RawConfig
        data-test-raw-config="true"
        @source={{config.source}}
        @config={{get config 'config'}}
        @loading={{this.loading}}
        @build={{@request.build}}
        @slug={{@request.repo.slug}}
      />
    {{else}}
      <div class="starred-empty">
        The .travis.yml file used for this job is not available
      </div>
    {{/each}}

    <Request::Config
      data-test-request-config="true"
      @config={{this.request.config}}
    />
  </div>
{{/if}}
